<!DOCTYPE html>

<html>
  <head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script>
        var posicio=13;  //exterior
        
      function changeBG() {
        document.querySelector('#fons').setAttribute('src', '#'+posicio);
        
        switch(posicio) {
          case 13: showButtons(1,0,0,0); break;
          case 23: showButtons(1,1,1,1); break;
          case 22: showButtons(0,1,0,1); break;
          case 21: showButtons(1,1,0,0); break;
          case 31: showButtons(1,0,1,1); break;
          case 30: showButtons(0,1,0,0); break;
          case 41: showButtons(1,0,1,0); break;
          case 51: showButtons(0,0,1,1); break;
          case 33: showButtons(0,0,1,0); break;
          case 24: showButtons(0,1,0,1); break;
          case 25: showButtons(1,1,0,1); break;
          case 26: showButtons(0,1,0,1); break;
          case 27: showButtons(1,1,0,1); break;
          case 28: showButtons(0,1,0,1); break;
          case 29: showButtons(0,0,0,1); break;
          case 35: showButtons(0,0,1,0); break;
          case 37: showButtons(0,0,1,0); break;
          case 50: showButtons(0,1,0,0); break;
          case 51: showButtons(0,1,0,0); break;
          default:
            posicio = 13; //En cas d'error, tornem al principi.
            changeBG();
        }
      }
      
      function showButtons(n, o, s, e) {
        //1 = show
        //0 = hide
        
        let newRotation = n ? 0 : 180;
        document.querySelector('#sortidaN').setAttribute('rotation', '0 ' + newRotation + ' 0');
        
        newRotation = o ? 270 : 90;
        document.querySelector('#sortidaO').setAttribute('rotation', '0 ' + newRotation + ' 0');
        
        newRotation = s ? 180 : 0;
        document.querySelector('#sortidaS').setAttribute('rotation', '0 ' + newRotation + ' 0');
        
        newRotation = e ? 90 : 270;
        document.querySelector('#sortidaE').setAttribute('rotation', '0 ' + newRotation + ' 0');
        
      }
      
      
        AFRAME.registerComponent("mylink", {
        init: function() {  
         this.el.addEventListener("click", (e) => {
           
             switch(e.target.id) {
               case 'sortidaN':
                 posicio+=10;
                 break;
               case 'sortidaS':
                 posicio-=10;
                 break;
               case 'sortidaO':
                 posicio+=1;
                 break;
               case 'sortidaE':
                 posicio-=1;
                 break;
               default:
                 console.log('Error');
             }
           changeBG();
           console.log(posicio);
           })
         }
         })
  
    </script>

  </head>
  <body>
  <a-scene cursor="rayOrigin: mouse">
    <a-assets> 
        <img id="13" src="assets/13.JPG" >
        <img id="21" src="assets/21.JPG" >
        <img id="22" src="assets/22.JPG" >

        <img id="23" src="assets/23.JPG" >
        <img id="24" src="assets/24.JPG" >
        <img id="25" src="assets/25.JPG" >

        <img id="26" src="assets/26.JPG" >
        <img id="27" src="assets/27.JPG" >
        <img id="28" src="assets/28.JPG" >

        <img id="29" src="assets/29.JPG" >
        <img id="30" src="assets/30.JPG" >
        <img id="31" src="assets/31.JPG" >

        <img id="33" src="assets/33.JPG" >
        <img id="35" src="assets/35.JPG" >
        <img id="37" src="assets/37.JPG" >

        <img id="41" src="assets/41.JPG" >
        <img id="50" src="assets/50.JPG" >
        <img id="51" src="assets/51.JPG" >
      
      
      
       <img id="imgSortida" src="assets/entragroc.png" >
    </a-assets>
   
    <a-entity camera look-controls wasd-controls="false">
    <!-- fuseTimeout = el temps que triga en fer click des de que es posiciona sobre un objecte-->
     <a-entity cursor="fuse: true; fuseTimeout: 2000"
           position="0 0 -1"
           geometry="primitive: circle; radius: 0.005;"
           material="color: red; shader: flat"
           animation="property: components.material.material.color;
                 type: color;
                 to: white;
                 dur: 1000;
                 dir: alternate;
                 loop: true">
     </a-entity>
    </a-entity>
    <a-sky id="fons" src="#13">
        <a-plane id="sortidaN" position="0 1 -5" src="#imgSortida" rotation="0 0 0"   transparent="true" mylink=""
                 animation="property: position; dur: 500; from: 0 1 -5; to: 0 1 -4.5; dir: alternate; loop: true"
                 ></a-plane>
        <a-plane id="sortidaO" position="5 1 0" src="#imgSortida" rotation="0 90 0"  transparent="true" mylink=""
                  animation="property: position; dur: 500; from: 5 1 0; to: 4.5 1 0; dir: alternate; loop: true"
                 ></a-plane>
        <a-plane id="sortidaS" position="0 1 5" src="#imgSortida" rotation="0 0 0"  transparent="true" mylink=""
                  animation="property: position; dur: 500; from: 0 1 5; to: 0 1 4.5; dir: alternate; loop: true"
                 ></a-plane>
        <a-plane id="sortidaE" position="-5 1 0" src="#imgSortida" rotation="0 270 0"  transparent="true" mylink=""
                 animation="property: position; dur: 500; from: -5 1 0; to: -4.5 1 0; dir: alternate; loop: true"
                 ></a-plane>
        
      </a-sky>
    </a-scene>
  </body>
</html>